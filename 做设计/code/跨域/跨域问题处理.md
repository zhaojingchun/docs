# 跨域问题



## 方法1

```xml
<!--跨域-->
<dependency>
    <groupId>com.thetransactioncompany</groupId>
    <artifactId>cors-filter</artifactId>
    <version>2.3</version>
</dependency>
<!--跨域 end-->
```



```java
import com.thetransactioncompany.cors.CORSConfiguration;
import com.thetransactioncompany.cors.CORSConfigurationException;
import org.springframework.boot.web.servlet.FilterRegistrationBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import java.util.Properties;
/**
 * @description:
 * @Date: 2021/12/6
 */
@Configuration
public class CorsConfig {
    @Bean
    public FilterRegistrationBean registrationBean() throws CORSConfigurationException {
        Properties property = new Properties();
        property.setProperty("cors.supportedMethods", "GET, POST, HEAD, OPTIONS, PUT, DELETE");
        CORSConfiguration configuration = new CORSConfiguration(property);
        FilterRegistrationBean bean = new FilterRegistrationBean(new CorsFilter(configuration));
        // 过滤路径
        bean.addUrlPatterns("/*");
        bean.setOrder(1);
        return bean;
    }
}

```



```java
import com.thetransactioncompany.cors.CORSConfiguration;
import com.thetransactioncompany.cors.CORSFilter;
import javax.servlet.FilterConfig;

/**
 * @description:
 * @Date: 2021/12/6
 */
public class CorsFilter extends CORSFilter {

    /**
     *
     * @param configuration
     */
    public CorsFilter(CORSConfiguration configuration) {
        super(configuration);
    }

    /**
     * 空写父类init，防止将组装的数据重新初始化没
     * @param filterConfig
     */
    @Override
    public void init(FilterConfig filterConfig){
    }
}

```



### 前端nginx 配置

```java

    add_header Access-Control-Allow-Origin *;
    add_header Access-Control-Allow-Headers 'X-Requested-With,Content-Type,Access-Token,Appid,Secret,Authorization,Cache-Control';
    add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';
    add_header Access-Control-Allow-Credentials 'true';
    add_header Access-Control-Expose-Headers 'Content-Type,Location,Connection,Date,Server,Transfer-Encoding';
    if ($request_method = 'OPTIONS') {
        return 204;
    }
```

## 参考

https://cloud.tencent.com/developer/article/1513473